#!/bin/bash

# Define the directory to search in
search_directory="public_html"

# Define the array of potentially malicious PHP code keywords
malicious_keywords=(
    "eval"
    "base64_decode"
    "exec"
    "system"
    "passthru"
    "shell_exec"
    "assert"
    "preg_replace"
    "file_put_contents"
    "unlink"
    "readfile"
    "include"
    "include_once"
    "require"
    "require_once"
    "\$_REQUEST"
    "\$_POST"
    "\$_GET"
    "@"
    "c99shell"
    "r57shell"
    "WebShell"
    # Add more keywords as needed
)

# Define the report file
report_file="malicious_code_report.txt"

# Find all files in the directory and subdirectories
# and use grep to search for the malicious keywords
for keyword in "${malicious_keywords[@]}"; do
    echo "Searching for keyword: $keyword"
    grep -rnwl "$search_directory" -e "$keyword" |
    while read -r matched_file; do
        echo -e "Matched \e[32m$keyword\e[0m in $matched_file"
        echo "Matched $keyword in $matched_file" >> "$report_file"
    done
done

echo "Report saved to $report_file"
